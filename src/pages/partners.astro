---
import { getCollection, getEntry } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const partners = await getCollection('partners');
const page = await getEntry('pages', 'partners.md');

const grouped = partners.reduce<Record<string, typeof partners>>((acc, partner) => {
  const key = partner.data.category;
  if (!acc[key]) acc[key] = [];
  acc[key].push(partner);
  return acc;
}, {});
---

<BaseLayout title="Techmach | Partners" description={page?.data.intro}>
  <section class="mx-auto max-w-7xl px-6 py-16">
    <h1 class="mb-4 text-4xl font-bold">Partners</h1>
    <p class="mb-10 max-w-3xl text-slate-700">{page?.data.intro}</p>
    <div class="space-y-10">
      {Object.entries(grouped).map(([category, items]) => (
        <div>
          <h2 class="mb-4 text-xl font-semibold">{category}</h2>
          <div class="grid grid-cols-2 gap-6 md:grid-cols-4">
            {items?.map((partner) => (
              <a href={partner.data.website ?? '#'} class="flex h-28 items-center justify-center rounded border border-slate-200 bg-white p-4" target="_blank" rel="noreferrer">
                <img src={partner.data.logo} alt={partner.data.name} class="max-h-14 w-auto object-contain" loading="lazy" />
              </a>
            ))}
          </div>
        </div>
      ))}
    </div>
  </section>
</BaseLayout>
